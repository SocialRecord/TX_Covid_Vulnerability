import pandas as pd


def acquire_income_data():
    '''
    This function cleans the Income csv housed in the Data file of the repository
    and returns a dataframe ready to be joined on
    '''
    # Read in csv and set inded to FIPS
    df = pd.read_csv('../Data/Income.csv')
    df = df.set_index('FIPS')

    # Create a boolean mask where only observations where TX is the state are counted as true
    # Then apply the mask to the whole dataframe
    mask = df['State'] == 'TX'
    df = df[mask]

    # Drop columns we don't need
    df = df.drop(
        columns = ['PerCapitaInc', 
        'PovertyUnder18Pct', 
        'PovertyAllAgesPct', 
        'Deep_Pov_Children',
        'State',
        'County'])

    return df

def acquire_food_data():
    '''
    Clean and prepare the Food1 excel file and 
    return it as a dataframe ready to be joined on
    '''

    # Pull in only the columns I want
    file_loc = "../Data/Food1.xlsx"
    df = pd.read_excel(file_loc, index_col='FIPS', na_values=['NA'], usecols = "A,B,E")

    # Restrict df to Texas only
    mask = df['State'] == 'TX'
    df = df[mask]

    # Drop the state column
    df = df.drop(columns = 'State')
    return df


    

