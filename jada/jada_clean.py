import pandas as pd


def clean_income():
    '''
    This function cleans the Income csv housed in the Data file of the repository
    and returns a dataframe ready to be joined on
    '''
    # Read in csv and set inded to FIPS
    income = pd.read_csv('../Data/Income.csv')
    income = income.set_index('FIPS')

    # Create a boolean mask where only observations where TX is the state are counted as true
    # Then apply the mask to the whole dataframe
    mask = income['State'] == 'TX'
    income = income[mask]

    # Drop columns we don't need
    income = income.drop(
        columns = ['PerCapitaInc', 'PovertyUnder18Pct', 'PovertyAllAgesPct', 'Deep_Pov_Children'])

    return income